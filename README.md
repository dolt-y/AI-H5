# AI-H5 Â· æ™ºèƒ½å¯¹è¯åŠ©æ‰‹åº”ç”¨

[![Vue 3](https://img.shields.io/badge/Vue-3.5.13-brightgreen)](https://vuejs.org/)
[![TypeScript](https://img.shields.io/badge/TypeScript-5.8-blue)](https://www.typescriptlang.org/)
[![Vite](https://img.shields.io/badge/Vite-6.3.5-green)](https://vitejs.dev/)
[![License](https://img.shields.io/badge/License-MIT-yellow)](#)

ä¸€ä¸ªç°ä»£åŒ–çš„ AI æ™ºèƒ½å¯¹è¯åº”ç”¨ï¼ŒåŸºäº Vue 3 + TypeScriptï¼Œæ”¯æŒæµå¼å“åº”ã€ä¼šè¯ç®¡ç†ã€å¤šæ¨¡å‹åˆ‡æ¢ï¼Œæä¾›ä¼˜é›…çš„ç”¨æˆ·ä½“éªŒã€‚

## âœ¨ æ ¸å¿ƒç‰¹æ€§

### ğŸš€ æµå¼æ•°æ®å¤„ç†
- **SSEï¼ˆServer-Sent Eventsï¼‰æµå¼æ¥æ”¶**ï¼šå®ç°äº†å®Œæ•´çš„æµå¼æ•°æ®å¤„ç†æœºåˆ¶ï¼Œåœ¨æ”¶åˆ°ç¬¬ä¸€å—æ•°æ®æ—¶ç«‹å³æ¸²æŸ“
- **åˆ†å—è§£æä¸ç¼“å†²**ï¼šæ”¯æŒå¤šè¡Œ SSE äº‹ä»¶çš„æ­£ç¡®è§£æï¼Œå¤„ç†ä¸å®Œæ•´çš„æ•°æ®å—
- **å®æ—¶æ¸²æŸ“åé¦ˆ**ï¼šä½¿ç”¨ `requestAnimationFrame` ä¼˜åŒ–æ¸²æŸ“æ€§èƒ½ï¼Œé¿å…é¢‘ç¹ DOM æ›´æ–°å¯¼è‡´çš„å¡é¡¿

### ğŸ’¬ å¯¹è¯ç®¡ç†
- **æ¶ˆæ¯è¿½è¸ªç³»ç»Ÿ**ï¼šè‡ªåŠ¨ç”Ÿæˆå”¯ä¸€æ¶ˆæ¯ IDï¼Œç»´æŠ¤æ¶ˆæ¯çŠ¶æ€ï¼ˆpending/success/errorï¼‰
- **ä¼šè¯éš”ç¦»**ï¼šæ”¯æŒå¤šä¼šè¯å¹¶è¡Œï¼Œå¯åˆ›å»ºã€åˆ‡æ¢ã€ç®¡ç†å†å²ä¼šè¯
- **æ¶ˆæ¯å¿«ç…§å­˜å‚¨**ï¼šä¿å­˜ç”¨æˆ·æ¶ˆæ¯ä¸ AI å›å¤çš„å®Œæ•´ä¸Šä¸‹æ–‡

### ğŸ¨ äº¤äº’ä¼˜åŒ–
- **æ€è€ƒä¸­åŠ è½½åŠ¨ç”»**ï¼šAI å›å¤å»¶è¿Ÿæ—¶çš„ä¼˜é›… UXâ€”â€”æµå¼æ•°æ®åˆ°è¾¾æ—¶å³åˆ»æ¶ˆå¤±
- **è‡ªåŠ¨æ»šåŠ¨å®šä½**ï¼šæ™ºèƒ½æ»šåŠ¨åˆ°æœ€æ–°æ¶ˆæ¯ï¼Œæ”¯æŒæŒ‡å®šæ¶ˆæ¯å®šä½ï¼Œé¿å…å†…å®¹å˜åŒ–å¯¼è‡´çš„æ»šåŠ¨ä½ç½®åç§»
- **æ¶ˆæ¯æ“ä½œé¢æ¿**ï¼šæ”¯æŒå¤åˆ¶ã€ç‚¹èµã€é‡æ–°ç”Ÿæˆç­‰äº¤äº’åŠŸèƒ½

### ğŸ¯ å¤šæ¨¡å‹æ”¯æŒ
- **æ¨¡å‹åˆ‡æ¢å™¨**ï¼šæ”¯æŒåœ¨å¯¹è¯è¿‡ç¨‹ä¸­åŠ¨æ€é€‰æ‹©ä¸åŒ AI æ¨¡å‹
  - **å¿«é€Ÿé—®ç­”æ¨¡å¼**ï¼ˆdeepseek-chatï¼‰
  - **æ·±åº¦æ€è€ƒæ¨¡å¼**ï¼ˆdeepseek-reasonerï¼‰
- **æ¨¡å‹é…ç½®çµæ´»æ€§**ï¼šæ˜“äºæ‰©å±•å…¶ä»– AI æä¾›å•†

### ğŸ“ Markdown æ¸²æŸ“
- **å®Œæ•´çš„ Markdown æ”¯æŒ**ï¼šåŒ…æ‹¬ä»£ç å—ã€è¡¨æ ¼ã€åˆ—è¡¨ã€å¼•ç”¨ç­‰
- **ä»£ç é«˜äº®**ï¼šä½¿ç”¨ highlight.js å®ç°å¤šè¯­è¨€ä»£ç ç€è‰²
- **HTML å®‰å…¨æ¸²æŸ“**ï¼šé…ç½®åŒ–å¤„ç†ï¼Œæ”¯æŒé“¾æ¥è‡ªåŠ¨æ–°çª—å£æ‰“å¼€

### ğŸ¨ è®¾è®¡ç³»ç»Ÿ
- **ç°ä»£æ¸å˜è®¾è®¡**ï¼šæ¸å˜è‰²ï¼ˆç´«â†’ç´«â†’ç²‰ï¼‰è´¯ç©¿æ•´ä¸ªåº”ç”¨
- **å“åº”å¼å¸ƒå±€**ï¼šåŸºäº CSS å˜é‡çš„æ·±æµ…ä¸»é¢˜æ”¯æŒ
- **åŠ¨ç”»ç»†èŠ‚**ï¼šå¹³æ»‘çš„æ¶ˆæ¯æ»‘å…¥ã€åŠ è½½è½¬åœˆã€è„‰å†²æ•ˆæœç­‰

## ğŸ—ï¸ é¡¹ç›®ç»“æ„

```
src/
â”œâ”€â”€ components/              # Vue ç»„ä»¶åº“
â”‚   â”œâ”€â”€ MessageItem.vue      # å•æ¡æ¶ˆæ¯æ¸²æŸ“ç»„ä»¶ï¼ˆå« Markdown è§£æã€æ“ä½œé¢æ¿ï¼‰
â”‚   â”œâ”€â”€ InputArea.vue        # è¾“å…¥æ¡†åŠå·¥å…·æ ï¼ˆå«æ¨¡å‹é€‰æ‹©ã€å½•éŸ³ã€æ–°å»ºä¼šè¯ï¼‰
â”‚   â”œâ”€â”€ HistroySessions.vue  # å†å²ä¼šè¯ç®¡ç†å¼¹çª—
â”‚   â””â”€â”€ HelloWorld.vue       # ç¤ºä¾‹ç»„ä»¶
â”œâ”€â”€ utils/
â”‚   â”œâ”€â”€ type.ts              # TypeScript ç±»å‹å®šä¹‰ï¼ˆChatMessageã€Session ç­‰ï¼‰
â”‚   â”œâ”€â”€ request.ts           # HTTP è¯·æ±‚å°è£…ï¼ˆget/postï¼‰
â”‚   â”œâ”€â”€ streamRequest.ts     # SSE æµå¼è¯·æ±‚å®ç°
â”‚   â””â”€â”€ markdown.ts          # Markdown æ¸²æŸ“å¼•æ“é…ç½®
â”œâ”€â”€ assets/                  # é™æ€èµ„æº
â”‚   â”œâ”€â”€ regenerate-icon.svg  # é‡æ–°ç”ŸæˆæŒ‰é’®å›¾æ ‡
â”‚   â”œâ”€â”€ copy-icon.svg        # å¤åˆ¶æŒ‰é’®å›¾æ ‡
â”‚   â”œâ”€â”€ like-icon.svg        # ç‚¹èµæŒ‰é’®å›¾æ ‡
â”‚   â”œâ”€â”€ thinking-icon.svg    # æ€è€ƒä¸­åŠ è½½åŠ¨ç”»
â”‚   â””â”€â”€ logo1.png            # AI è§’è‰²å¤´åƒ
â”œâ”€â”€ App.vue                  # ä¸»åº”ç”¨ç»„ä»¶ï¼ˆæ ¸å¿ƒä¸šåŠ¡é€»è¾‘ï¼‰
â”œâ”€â”€ main.ts                  # åº”ç”¨å…¥å£
â””â”€â”€ style.scss               # å…¨å±€æ ·å¼ä¸è®¾è®¡ç³»ç»Ÿå˜é‡
```

## ğŸ”§ æŠ€æœ¯æ ˆ

| æŠ€æœ¯ | ç‰ˆæœ¬ | ç”¨é€” |
|-----|------|------|
| Vue | 3.5.13 | å‰ç«¯æ¡†æ¶ |
| TypeScript | 5.8 | ç±»å‹å®‰å…¨ |
| Vite | 6.3.5 | æ„å»ºå·¥å…· |
| Markdown-it | 14.1.0 | Markdown æ¸²æŸ“ |
| highlight.js | å†…ç½® | ä»£ç é«˜äº® |
| SCSS | 1.94.2 | æ ·å¼é¢„å¤„ç† |
| Element Plus | 2.10.4 | UI ç»„ä»¶åº“ï¼ˆå¯é€‰ï¼‰ |
| socket.io-client | 4.8.1 | WebSocket æ”¯æŒï¼ˆé¢„ç•™ï¼‰ |

## ğŸ“¥ å¿«é€Ÿå¼€å§‹

### å‰ç½®è¦æ±‚
- Node.js >= 16
- npm æˆ– yarn

### å®‰è£…ä¾èµ–
```bash
npm install
```

### å¼€å‘æœåŠ¡å™¨
```bash
npm run dev
```
è®¿é—® `http://localhost:5173`

### ç”Ÿäº§æ„å»º
```bash
npm run build
```

æ„å»ºè¾“å‡ºåˆ° `dist/` ç›®å½•

### é¢„è§ˆæ„å»ºç»“æœ
```bash
npm run preview
```

## ğŸ¯ æ ¸å¿ƒä¸šåŠ¡æµç¨‹

### å¯¹è¯æµç¨‹
```
ç”¨æˆ·è¾“å…¥ â†’ å‘é€æ¶ˆæ¯
    â†“
åˆ›å»º User Message (pending)
æ˜¾ç¤ºåœ¨æ¶ˆæ¯åˆ—è¡¨ â†’ è‡ªåŠ¨æ»šåŠ¨åˆ°åº•éƒ¨
    â†“
è°ƒç”¨ streamFetchï¼ˆPOST /api/ai/chatï¼‰
Assistant Message åˆ›å»º (pending)
    â†“
SSE æ•°æ®æµå¼€å§‹æ¥æ”¶
    â”œâ”€ ç¬¬ä¸€å—æ•°æ®åˆ°è¾¾ â†’ status å˜ä¸º successï¼ˆæ€è€ƒä¸­ icon æ¶ˆå¤±ï¼‰
    â”œâ”€ æŒç»­æ¥æ”¶ â†’ å®æ—¶æ¸²æŸ“ Markdown å†…å®¹
    â””â”€ æ»šåŠ¨åˆ°æœ€æ–°æ¶ˆæ¯
    â†“
æµç»“æŸ (onDone) â†’ æœ€ç»ˆæ›´æ–°æ¶ˆæ¯çŠ¶æ€
    â†“
ç”¨æˆ·å¯è¿›è¡Œæ“ä½œï¼šå¤åˆ¶ã€ç‚¹èµã€é‡æ–°ç”Ÿæˆ
```

### ä¼šè¯ç®¡ç†æµç¨‹
```
æ–°å»ºä¼šè¯ â†’ POST /api/ai/sessions
    â†“
è·å– session.id â†’ ç”¨äºåç»­å¯¹è¯ä¸Šä¸‹æ–‡å…³è”
    â†“
åˆ‡æ¢å†å²ä¼šè¯ â†’ GET /api/ai/sessions/{id}/messages
    â†“
åŠ è½½å†å²æ¶ˆæ¯ â†’ ç­‰å¾… DOM ç¨³å®š â†’ æ™ºèƒ½æ»šåŠ¨åˆ°åº•éƒ¨
```

## ğŸ” API æ¥å£çº¦å®š

### å¯¹è¯æ¥å£
```typescript
POST /api/ai/chat
Body: {
  messages: Array<{ role: string; content: string }>,
  sessionId?: string | number,
  stream: true,
  model: string  // "deepseek-chat" | "deepseek-reasoner"
}
Response: æµå¼ SSE
  data: æ–‡æœ¬å—
  [å¯é€‰] event: äº‹ä»¶ç±»å‹
  [å¯é€‰] id: äº‹ä»¶ ID
```

### ä¼šè¯æ¥å£
```typescript
POST /api/ai/sessions
Body: { title: string; summary?: string }
Response: { session: { id: string | number; ... } }

GET /api/ai/sessions/{id}/messages
Response: { messages: Array<HistoryMessage> }
  HistoryMessage = {
    role: "assistant" | "user",
    content: string,
    created_at?: string
  }
```

## ğŸ’¡ äº®ç‚¹åˆ†æ

### 1. **é«˜æ€§èƒ½æµå¼æ¸²æŸ“**
- ä½¿ç”¨ requestAnimationFrame è¿›è¡Œ Markdown æ¸²æŸ“èŠ‚æµï¼Œé¿å…é¢‘ç¹é‡æ’/é‡ç»˜
- SSE æµæ•°æ®çš„åˆ†å—å¤„ç†å’Œç¼“å†²æœºåˆ¶ç¡®ä¿å³ä¾¿æ•°æ®åŒ…ä¸å®Œæ•´ä¹Ÿèƒ½æ­£ç¡®è§£æ
- æµå¼æ›´æ–°æ—¶çš„è‡ªåŠ¨æ»šåŠ¨é‡‡ç”¨ä¸¤å¸§ rAF ç­‰å¾…ï¼Œç¡®ä¿ CSS åŠ¨ç”»å’Œå¸ƒå±€ç¨³å®š

### 2. **ç”¨æˆ·ä½“éªŒçš„ç»†èŠ‚å…³æ€€**
- **æ€è€ƒä¸­çš„æ™ºèƒ½éšè—**ï¼šåœ¨ AI æµå¼æ•°æ®åˆ°è¾¾æ—¶ç«‹å³æ¶ˆå¤±ï¼Œè€Œéç­‰åˆ°å®Œå…¨å“åº”ç»“æŸ
- **è‡ªåŠ¨æ»šåŠ¨çš„å¯é æ€§**ï¼šé€šè¿‡è®¡ç®— offsetTop + offsetHeight çš„æ–¹å¼å®šä½ï¼Œè€Œéä¾èµ–æµè§ˆå™¨çš„ scrollIntoView
- **æ¶ˆæ¯çŠ¶æ€è¿½è¸ª**ï¼špending/success/error ä¸‰æ€è®¾è®¡ï¼Œæ¸…æ™°åæ˜ æ¶ˆæ¯ä¼ è¾“çŠ¶æ€

### 3. **è®¾è®¡ç³»ç»Ÿçš„ä¸€è‡´æ€§**
- å…¨å±€ CSS å˜é‡æ”¯æŒæ·±æµ…ä¸»é¢˜è‡ªåŠ¨åˆ‡æ¢
- æ¸å˜è‰²ã€é˜´å½±ã€åœ†è§’ç­‰è®¾è®¡å…ƒç´ é€šè¿‡å˜é‡ç»Ÿä¸€ç®¡ç†
- å›¾æ ‡é‡‡ç”¨ SVG æ¢¯åº¦åŒ–è®¾è®¡ï¼Œè§†è§‰é£æ ¼é«˜åº¦ç»Ÿä¸€

### 4. **ç±»å‹å®‰å…¨çš„æ¶æ„**
- å®Œæ•´çš„ TypeScript ç±»å‹å®šä¹‰ï¼ˆChatMessageã€Sessionã€ModelOption ç­‰ï¼‰
- å¼ºç±»å‹çš„ API æ¥å£çº¦å®šï¼Œé¿å…è¿è¡Œæ—¶é”™è¯¯
- ç¼–è¯‘æœŸé™æ€æ£€æŸ¥ç¡®ä¿é‡æ„å®‰å…¨

### 5. **å¯æ‰©å±•çš„ä¼šè¯è®¾è®¡**
- å¤šä¼šè¯éš”ç¦»ï¼Œæ”¯æŒå¹¶è¡Œå¯¹è¯
- Session ID ä¸æ¶ˆæ¯ç»‘å®šï¼Œä¾¿äºåç«¯å…³è”ä¸Šä¸‹æ–‡
- å†å²æ¶ˆæ¯çš„å¿«ç…§å­˜å‚¨ï¼Œæ”¯æŒä»»æ„æ—¶é—´ç‚¹çš„æ¢å¤

## ğŸ¨ è®¾è®¡äº®ç‚¹

### æ¸å˜è‰²ç³»ç»Ÿ
```scss
--color-accent: #6366f1        // ç´«
--color-accent-strong: #8b5cf6 // ç´«
--color-accent-contrast: #ec4899 // ç²‰
```
è´¯ç©¿æ‰€æœ‰äº¤äº’å…ƒç´ çš„è§†è§‰ä¸»çº¿

### å“åº”å¼ä¸»é¢˜
```scss
:root {
  // Light mode
  --color-bg-primary: #f5f7ff;
  --color-text-primary: #273156;
}

@media (prefers-color-scheme: dark) {
  :root {
    // Dark mode
    --color-bg-primary: #0f172a;
    --color-text-primary: #e2e8f0;
  }
}
```

## ğŸ“± æµè§ˆå™¨å…¼å®¹æ€§

- Chrome 90+
- Firefox 88+
- Safari 14+
- Edge 90+

## ğŸš€ æ€§èƒ½æŒ‡æ ‡

- é¦–å±åŠ è½½æ—¶é—´ < 2sï¼ˆå–å†³äºç½‘ç»œï¼‰
- SSE æµå¼å“åº”é¦–å­—èŠ‚æ—¶é—´ < 2sï¼ˆå–å†³äº AI æœåŠ¡ï¼‰
- æ¶ˆæ¯æ¸²æŸ“å¸§ç‡ > 30fpsï¼ˆå¤§æ–‡æœ¬åœºæ™¯ï¼‰

## ğŸ”„ åç»­ä¼˜åŒ–æ–¹å‘

- [ ] è¯­éŸ³è¾“å…¥å®Œæ•´å®ç°ï¼ˆå½“å‰é¢„ç•™ï¼‰
- [ ] æ¶ˆæ¯æœç´¢ä¸è¿‡æ»¤
- [ ] å¯¼å‡ºå¯¹è¯è®°å½•ï¼ˆPDFã€Markdownï¼‰
- [ ] ç¦»çº¿æ¶ˆæ¯é˜Ÿåˆ—ï¼ˆPWAï¼‰
- [ ] ç”¨æˆ·è®¤è¯ä¸æˆæƒä½“ç³»
- [ ] æ•°æ®åŠ å¯†ä¼ è¾“
- [ ] æ›´å¤š AI æ¨¡å‹é›†æˆ

## ğŸ“„ ç›¸å…³æ–‡ä»¶è¯´æ˜

| æ–‡ä»¶ | è¯´æ˜ |
|-----|------|
| `streamRequest.ts` | SSE æµå¼æ•°æ®è§£æçš„æ ¸å¿ƒå®ç°ï¼Œæ”¯æŒå¤šè¡Œ data å­—æ®µ |
| `App.vue` | ä¸»ä¸šåŠ¡é€»è¾‘ï¼ŒåŒ…å«å¯¹è¯æµç¨‹ã€ä¼šè¯ç®¡ç†ã€è‡ªåŠ¨æ»šåŠ¨ä¼˜åŒ– |
| `MessageItem.vue` | æ¶ˆæ¯æ¸²æŸ“ä¸äº¤äº’ï¼Œæ€è€ƒä¸­åŠ è½½åŠ¨ç”»ã€Markdown è§£æã€æ“ä½œæŒ‰é’® |
| `InputArea.vue` | è¾“å…¥æ¡†ã€æ¨¡å‹åˆ‡æ¢ã€ä¼šè¯æ“ä½œ |
| `markdown.ts` | Markdown-it é…ç½®ï¼Œä»£ç é«˜äº®ã€é“¾æ¥å¤„ç† |
| `style.scss` | å…¨å±€è®¾è®¡ç³»ç»Ÿï¼Œæ¸å˜ã€ä¸»é¢˜ã€åŠ¨ç”» |

## ğŸ¤ è´¡çŒ®æŒ‡å—

æ¬¢è¿ PR å’Œ Issueï¼

## ğŸ“ è®¸å¯è¯

MIT License

---
**æœ€åæ›´æ–°**: 2025å¹´12æœˆ3æ—¥  
**Repository**: [github.com/dolt-y/AI-H5](https://github.com/dolt-y/AI-H5)
